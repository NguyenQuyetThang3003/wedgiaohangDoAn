@model IEnumerable<WedNightFury.Models.Order>

@{
    ViewData["Title"] = "Lá»™ trÃ¬nh hÃ´m nay";
    Layout = "~/Views/Shared/_LayoutDriver.cshtml";
}

<style>
    .order-card {
        border-radius: 12px;
        border: none;
        padding: 20px;
        transition: 0.2s;
    }

    .order-card:hover {
        transform: scale(1.01);
        box-shadow: 0px 4px 16px rgba(0,0,0,0.1);
    }

    .info-label {
        font-weight: 600;
        color: #555;
    }
</style>

<div class="container">

    <h3 class="fw-bold mb-4">ğŸ“ Lá»™ trÃ¬nh giao hÃ ng hÃ´m nay</h3>

    @if (Model == null || !Model.Any())
    {
        <div class="alert alert-info shadow-sm">
            HÃ´m nay báº¡n chÆ°a cÃ³ Ä‘Æ¡n nÃ o cáº§n giao.
        </div>
    }
    else
    {
        foreach (var o in Model)
        {
            // Chuáº©n hÃ³a Ä‘á»‹a chá»‰ Ä‘á»ƒ dÃ¹ng cho Google Maps
            var address = o.ReceiverAddress ?? "";
            var fullAddress = string.IsNullOrWhiteSpace(address)
                ? "Viá»‡t Nam"
                : address + ", Viá»‡t Nam";  // tÄƒng Ä‘á»™ chÃ­nh xÃ¡c
            var encoded = System.Uri.EscapeDataString(fullAddress);

            <div class="order-card shadow-sm bg-white mb-4">

                <!-- Header -->
                <div class="d-flex justify-content-between align-items-center">
                    <h5 class="fw-bold">ÄÆ¡n: @o.Code</h5>

                    <span class="badge 
                        @(o.Status == "pending"  ? "bg-warning text-dark" :
                          o.Status == "shipping" ? "bg-primary" :
                          o.Status == "done"     ? "bg-success" : "bg-danger")">
                        @o.Status?.ToUpper()
                    </span>
                </div>

                <hr />

                <!-- Info -->
                <div class="row">

                    <div class="col-md-6 mb-2">
                        <p><span class="info-label">ğŸ‘¤ NgÆ°á»i nháº­n:</span> @o.ReceiverName</p>
                        <p><span class="info-label">ğŸ“ SÄT:</span> @o.ReceiverPhone</p>
                        <p><span class="info-label">ğŸ“ Äá»‹a chá»‰:</span> @o.ReceiverAddress</p>
                    </div>

                    <div class="col-md-6 mb-2">
                        <p><span class="info-label">ğŸ“¦ Sáº£n pháº©m:</span> @o.ProductName</p>
                        <p><span class="info-label">âš– CÃ¢n náº·ng:</span> @o.Weight kg</p>
                        <p>
                            <span class="info-label">ğŸ’° COD:</span>
                            @o.CodAmount.ToString("N0") Ä‘
                        </p>
                    </div>

                </div>

                <!-- Buttons -->
                <div class="mt-3">

                    <!-- Báº¯t Ä‘áº§u giao â†’ StopDetail -->
                    <a asp-controller="Trip"
                       asp-action="StopDetail"
                       asp-route-id="@o.Id"
                       class="btn btn-sm btn-primary">
                        ğŸš€ Báº¯t Ä‘áº§u giao
                    </a>

                    <!-- Báº£n Ä‘á»“ â†’ má»Ÿ trá»±c tiáº¿p Google Maps Ä‘iá»u hÆ°á»›ng -->
                    <a class="btn btn-sm btn-outline-dark"
                       target="_blank"
                       href="https://www.google.com/maps/dir/?api=1&destination=@encoded">
                        ğŸ—º Báº£n Ä‘á»“
                    </a>

                    <!-- Chi tiáº¿t -->
                    <a asp-controller="Trip"
                       asp-action="StopDetail"
                       asp-route-id="@o.Id"
                       class="btn btn-sm btn-outline-secondary">
                        ğŸ“„ Chi tiáº¿t
                    </a>

                </div>

            </div>
        }
    }
</div>
